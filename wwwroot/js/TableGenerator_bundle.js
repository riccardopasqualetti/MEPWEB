var TableGenerator;(()=>{"use strict";var e={d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};(()=>{e.d(t,{default:()=>a});class a{constructor(e){this.currentPage=1,this.paramObject=e,this.logs=0,this.addParamObj={},this.name=e.name,this.apiResponse,this.maxPageButtons=5,this.isTableCreated=!1,this.modalOptions={create:{fields:{},onSuccess:null,onError:null},update:{fields:{},onSuccess:null,onError:null},delete:{fields:{},name:"",onSuccess:null,onError:null}}}async logon(){const e={grant_type:"password",username:this.paramObject.credentials.username,password:this.paramObject.credentials.password,client_id:"test",client_secret:"3700C5A7-DA54-4C60-802C-B879AC960335",company:this.paramObject.credentials.company},t={method:"POST",mode:"cors",body:new URLSearchParams(e)},a=`${this.paramObject.apiUrl.get.url[0]}api/Login/LoginSCC`;return await this.fetchApi(a,t)}destroyTable(){document.getElementById(`create-record-${this.name}`).remove(),document.getElementById(`update-record-${this.name}`).remove(),document.getElementById(`delete-record-${this.name}`).remove(),document.getElementById("tgen").innerHTML=""}async openCreateModal(e=this.modalOptions.create){let t=new bootstrap.Modal(`#create-record-${this.name}`);this.logger(t),this.modalOptions.create=e;for(const e in this.modalOptions.create.fields)document.getElementById(`create-${this.name}-${e}-hidden`).value=this.modalOptions.create.fields[e];t.show()}async openUpdateModal(e=this.modalOptions.update){const{fields:t}=e;let a=new bootstrap.Modal(`#update-record-${this.name}`);this.modalOptions.update=e,a.show();for(const e in t){const n=a._dialog.querySelector(`*[name="${e}"]`),l=this.paramObject.fields.find((t=>t.apiName==e&&0!=t.modals));if("checkbox"==l.type)n.checked="S"==t[e];else if("decimalColor"==l.type){const a=this.getRGBFromNumber(t[e]);n.value=t[e],n.style.backgroundColor=`rgb(${a.red},${a.green},${a.blue})`,n.addEventListener("change",(e=>{const t=this.getRGBFromNumber(e.target.value);e.target.style.backgroundColor=`rgb(${t.red},${t.green},${t.blue})`}))}else if("datenormal"==l.type){let a=null==t[e]?"null":t[e].split("/").reverse().join("-");n.valueAsDate=new Date(a)}else if("datelong"==l.type){let a=null==t[e]?"null":t[e].split("/").reverse().join("-");n.valueAsDate=new Date(a)}else{const l=Array.from(a._dialog.querySelectorAll(`#updateDialog *[name="${e}"]`)).find((e=>"hidden"==e.type));l&&(l.value=t[e]),n.value="null"==t[e]?"":t[e]}}}async openDeleteModal(e=this.modalOptions.delete){const{fields:t}=e,a=e.name||"",n=new bootstrap.Modal(`#delete-record-${this.name}`);this.modalOptions.delete=e,n.show();const l=n._dialog.querySelector(".modal-body");l.innerHTML="";const r=document.createElement("h6");if(r.innerText="Confermare l'eliminazione del record "+a,l.appendChild(r),t)for(const e of this.paramObject.apiUrl.delete.param)n._dialog.querySelector(`*[name="${e}"]`).value=t[e]}async createModals(){const e=async e=>{let t={method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.paramObject.authToken}},a=`${this.paramObject.apiUrl.get.url[0]+e}`;return this.logger(a),await this.fetchApi(a,t)},t=async(e,t)=>{let a={method:"PUT",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.paramObject.authToken},body:JSON.stringify(e)},n=`${this.paramObject.apiUrl.put.url[0]+this.paramObject.apiUrl.put.url[1]}`,l=await this.fetchApi(n,a,t);return this.logger(n),this.logger(l),l},a=async(e,t)=>{let a={method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.paramObject.authToken},body:JSON.stringify(e)};this.logger(a);let n=`${this.paramObject.apiUrl.post.url[0]}${this.paramObject.apiUrl.post.url[1]}`,l=await this.fetchApi(n,a,t);return this.logger(n),this.logger(l),l},n=async(e,t)=>{let a={method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.paramObject.authToken}};const n=this.paramObject.apiUrl.delete.param;let l="";if("querystring"==this.paramObject.apiUrl.delete.type){l+="?";for(let t=0;t<n.length;t++)l+=`${n[t]}=${e[n[t]]}`,t<n.length-1&&(l+="&")}else{l+="/";for(let t=0;t<n.length;t++)l+=`${e[n[t]]}`,t<n.length-1&&(l+="/")}let r=`${this.paramObject.apiUrl.delete.url[0]+this.paramObject.apiUrl.delete.url[1]}${l}`;this.logger(r);let o=await this.fetchApi(r,a,t);return this.logger(o),o},l=async t=>{const a=this.paramObject.fields.filter((e=>e.searchUrls&&e.apiName==t))[0];for(const t of a.searchUrls)if(0==document.querySelectorAll(`.modal *[name="${t.field}"]`).length){if(i[a.apiName])return;i[a.apiName]=await e(t.url)}},r=async(e,t,a,n)=>{const r=document.createElement("div");r.className="reswrap",e.appendChild(r);const s=document.createElement("div");s.className="research-div",r.classList.toggle("d-none"),r.appendChild(s);const i=document.createElement("div");i.className="row",s.appendChild(i);const d=document.createElement("div");d.className="col",i.appendChild(d);const c=document.createElement("div");c.backgroundColor="red",c.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512">\x3c!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --\x3e<path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"/></svg>',c.className="close-research",c.addEventListener("click",(()=>{r.classList.toggle("d-none")})),d.appendChild(c);const m=document.createElement("div");m.className="row",s.appendChild(m);const p=document.createElement("div");p.className="col g-0",p.style.marginLeft="1rem",m.appendChild(p);const u=document.createElement("table");u.className="table table-striped",p.appendChild(u);const h=document.createElement("thead");u.appendChild(h);const b=document.createElement("tr");h.appendChild(b),["Codice","Descrizione"].forEach((e=>{const t=document.createElement("th");t.innerText=e,b.appendChild(t)}));const g=document.createElement("tbody");g.id="research-table-body",u.appendChild(g);const y=document.createElement("div");y.className="row",s.appendChild(y);const f=document.createElement("div");f.className="col g-0",f.style.marginLeft="1rem",y.appendChild(f);let E=document.createElement("span");E.id="rLoader",E.className="layout-loader d-block",f.appendChild(E),e.appendChild(r),a.addEventListener("focus",(async e=>{if("true"==n.getAttribute("shown")){r.classList.remove("d-none");const s=n.getBoundingClientRect(),i=r.getBoundingClientRect().height+r.getBoundingClientRect().y;s.height<i&&(r.style.transform=`translateY(${s.height-i}px)`);const d=r.getBoundingClientRect().width+r.getBoundingClientRect().x;s.width<d&&(r.style.transform=`translateX(${s.width-d}px)`),await l(e.target.name),E.classList.remove("d-block"),g.innerHTML="",o(t,g,a,r)}})),a.classList.add("research-input")},o=(e,t,a,n)=>{t=t||document.getElementById("research-table-body"),i[e.apiName].forEach(((l,r)=>{const o=document.createElement("tr");o.tabIndex=r,o.addEventListener("focus",(e=>{a.value=e.target.children[0].textContent,n.classList.add("d-none")})),t.appendChild(o),e.searchUrls[0].searchFieldNames.forEach((e=>{const t=document.createElement("td");t.innerText=l[e],o.appendChild(t)}))}))},s=async t=>{this.logger(t.id);const a=t.querySelector(".modal-dialog");this.logger("Modal dialog qua sotto"),this.logger(a),this.logger(a.id+this.name),a.classList.add({c1:"max-w-25",c2:"max-w-40",c3:"max-w-55",c4:"max-w-70",c6:"max-w-90"}[this.paramObject.modals.create.width]);const n=a.querySelector(".modal-body");this.logger("clean modal fields"),n.innerHTML="";const l=this.paramObject.fields.filter((e=>0!=e.modals));for(let a=0;a<l.length;a++){const o=l[a];if(!o)break;const s=l[a].modalPosition.row;let i=document.getElementById(t.id+"-row-"+s);i||(i=document.createElement("div"),i.className="row",i.id=t.id+"-row-"+s,n.appendChild(i));const d=l[a].modalPosition.nCols,c=document.createElement("div");c.className=`col-md-${d} px-2`,i.appendChild(c);const m=document.createElement("div");m.style.position="relative",c.appendChild(m);let p,u=document.createElement("label");switch(u.innerText=o.displayedName.replace(/(\r\n|\n|\r)/gm,""),u.classNames="fs-14",u.for=`${t.id.split("-")[0]}-${this.name}-${o.apiName}`,m.appendChild(u),o.type){case"checkbox":let t=document.createElement("div");t.className="form-check",m.appendChild(t),p=document.createElement("input"),p.type="checkbox",p.checked=!1,p.className="form-check-input",t.appendChild(p);break;case"dropdown":if(p=document.createElement("select"),p.className="form-select",m.appendChild(p),!o.values){const t={},a=await e(o.searchUrls[0].url);for(const e of a)t["o"+e[o.searchUrls[0].searchFieldNames[0]]]=e[o.searchUrls[0].searchFieldNames[1]],o.searchUrls[0].searchFieldNames[2]&&(t["o"+e[o.searchUrls[0].searchFieldNames[0]]]+=" - "+e[o.searchUrls[0].searchFieldNames[2]]);o.values=t}for(let e of Object.entries(o.values)){const t=document.createElement("option");t.value=e[0].replace("o",""),t.innerText=e[1],p.appendChild(t)}break;case"decimalColor":p=document.createElement("select"),p.className="form-select",p.addEventListener("change",(e=>{const t=this.getRGBFromNumber(e.target.value);e.target.style.backgroundColor=`rgb(${t.red},${t.green},${t.blue})`})),m.appendChild(p);for(let e of Object.values(o.values)){const t=this.getRGBFromNumber(e),a=document.createElement("option");a.value=e,a.style.backgroundColor=`rgb(${t.red},${t.green},${t.blue})`,p.appendChild(a)}break;case"datelong":p=document.createElement("input"),p.type="datetime",p.className="form-control",m.appendChild(p);break;case"datenormal":p=document.createElement("input");let a=new Date;p.type="date",p.className="form-control",p.min="01-01-1800",p.max="01-01-2100",p.value=a.toISOString().substring(0,10),m.appendChild(p);break;case"number":p=document.createElement("input"),p.type="number",p.className="form-control",p.value=0,m.appendChild(p);break;default:p=document.createElement("input"),p.className="form-control mb-2",p.type="text",m.appendChild(p)}o.searchUrls&&"dropdown"!=o.type&&await r(m,o,p,t),"update"==t.id.split("-")[0]&&(this.logger("entrato in modal.id"),0==o.update&&(this.logger("entrato in field.update"),p.disabled=!0)),p.autocomplete="off",p.id=`${t.id.split("-")[0]}-${this.name}-${o.apiName}`,p.setAttribute("displayedName",o.displayedName),p.name=o.apiName,p.classList.add(t.id+"-input")}};let i={};const d=document.querySelector("#tgen"),c=[{name:"create",title:"Crea un nuovo record",submitBtn:"Inserisci record"},{name:"update",title:"Aggiorna un record",submitBtn:"Aggiorna record"},{name:"delete",title:"Elimina record",submitBtn:"Elimina record"}];for(const e of c){let l=document.createElement("div");l.className="modal fade user-none",l.id=`${e.name}-record-${this.name}`,l.tabIndex=-1,l.setAttribute("aria-labelledby",`${e.name}ModalLabel`),l.setAttribute("aria-hidden","true"),d.appendChild(l);const r=`response-message-container-${e.name}-${this.name}`,o=`submit-form-${e.name}-${this.name}`;l.innerHTML=`<div class="modal-dialog">\n                  <div class="modal-content">\n                  <form>\n                      <div class="modal-header">\n                          <h1 class="modal-title fs-5" id="${e.name}ModalTitle">${e.title}</h1>\n                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                      </div>\n                      <div class="modal-body">\n                      </div>\n                      <div class="modal-footer justify-content-between flex-column ">\n                          <div id="${r}" class="response-message-container d-flex align-content-center">\n                          </div>\n                          <div class="d-flex gap-1 w-100 justify-content-end">\n                              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>\n                              <button type="submit" class="btn btn-primary" id="${o}">${e.submitBtn}</button>\n                          </div>\n                          <div class="modal-loader d-none">\n                            <span class="layout-loader"></span>\n                          </div>\n                      </div>\n                      </form>\n                  </div>\n              </div>`;const i=l.querySelector("form");switch(e.name){case"create":this.paramObject.apiUrl.post.param.forEach((e=>{let t=document.createElement("input");t.type="hidden",t.id=`create-${this.name}-${e}-hidden`,t.name=e,i.appendChild(t)})),i.addEventListener("submit",(async e=>{e.preventDefault();const t=new FormData(e.target),n=Object.fromEntries(t.entries());for(let e of Object.keys(n))"null"==n[e]&&(n[e]=null),this.logger(e),"checkbox"==this.paramObject.fields.find((t=>t.apiName==e)).type&&("on"==n[e]?n[e]="S":n[e]="N");n.codiceDitta="01";const o=i.querySelector(".modal-loader"),s=m(await a(n,o),r);"success"==s?(l.querySelector(".modal-footer [data-bs-dismiss]").click(),await this.changePage(this.currentPage),this.modalOptions.create.onSuccess&&this.modalOptions.create.onSuccess()):"error"==s&&this.modalOptions.create.onError&&this.modalOptions.create.onError()})),this.logger(e.name),await s(l),l.addEventListener("hidden.bs.modal",(async()=>{await s(l)}));break;case"update":i.addEventListener("submit",(async e=>{e.preventDefault();const a=new FormData(e.target),n=Object.fromEntries(a.entries());for(let e of Object.keys(n))("null"==n[e]||this.paramObject.fields.find((t=>("datelong"==t.type||"datenormal"==t.type)&&t.apiName==e)))&&(n[e]=null),"checkbox"==this.paramObject.fields.find((t=>t.apiName==e)).type&&("on"==n[e]?n[e]="S":n[e]="N");n.codiceDitta="01";const o=i.querySelector(".modal-loader"),s=m(await t(n,o),r);"success"==s?(l.querySelector(".modal-footer [data-bs-dismiss]").click(),await this.changePage(this.currentPage),this.modalOptions.update.onSuccess&&this.modalOptions.update.onSuccess()):"error"==s&&this.modalOptions.update.onError&&this.modalOptions.update.onError()})),this.paramObject.apiUrl.put.param.forEach((e=>{let t=document.createElement("input");t.type="hidden",t.id="update-input-"+e,t.name=e,i.appendChild(t)})),this.logger(e.name),await s(l);break;case"delete":this.paramObject.apiUrl.delete.param.forEach((e=>{const t=document.createElement("input");t.type="hidden",t.id="delete-input-"+e,t.name=e,i.appendChild(t)})),i.addEventListener("submit",(async e=>{e.preventDefault();const t=new FormData(e.target),a=i.querySelector(".modal-loader"),o=Object.fromEntries(t.entries()),s=m(await n(o,a),r);"success"==s?(l.querySelector(".modal-footer [data-bs-dismiss]").click(),await this.changePage(this.currentPage),this.modalOptions.delete.onSuccess&&this.modalOptions.delete.onSuccess()):"error"==s&&this.modalOptions.delete.onError&&this.modalOptions.delete.onError()}));break;default:throw new Error("Method sbagliato: "+e.name)}}function m(e,t){if(!e)return;let a,n=document.getElementById(t);console.log("messagecontainer"),console.log(n),n.innerHTML="";let l=document.createElement("p");return e.status?(l.className="table-error",l.innerText=e.detail,a="error"):(l.className="table-success",l.innerText=e.response,a="success"),l.classList.add("m-0"),n.appendChild(l),a}Array.from(document.querySelectorAll(".modal")).forEach((e=>{e.addEventListener("show.bs.modal",(()=>{document.querySelectorAll(".response-message-container").forEach((e=>e.innerHTML=""))})),e.addEventListener("shown.bs.modal",(()=>{e.setAttribute("shown",!0)})),e.addEventListener("hidden.bs.modal",(()=>{e.setAttribute("shown",!1)}))}))}bodyGenerator(e,t){const a=e=>{let t=document.createElement("tr");t.tabIndex=e;let a=document.createElement("td");a.style.fontWeight="bold",a.innerText=e+1,t.appendChild(a);const n=document.createElement("td");t.appendChild(n);const l=document.createElement("button");l.id="editRecordBtn",l.className="btn-general-table",l.type="button",l.innerHTML='<svg height="16" width="16" viewBox="0 0 512 512"><path d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"/></svg>',l.setAttribute("data-bs-toggle","modal"),l.setAttribute("data-bs-target",`#update-record-${this.name}`),l.addEventListener("click",(()=>{this.paramObject.apiUrl.put.param.forEach((e=>{let t=l.parentElement.parentElement.querySelector(`td[fieldname="${e}"]`).getAttribute("valore"),a=document.querySelector("#update-input-"+e);a.value=t,a.type="hidden"})),document.querySelector("#updateModalTitle").innerText="Update the following record";const e=this.paramObject.fields.filter((e=>0!=e.modals)),t=Array.from(l.parentElement.parentElement.children).filter((e=>e.getAttribute("fieldname")&&null!=e));for(let a=0;a<e.length;a++){const n=t.find((t=>t.getAttribute("fieldname")==e[a].apiName)),l=document.getElementById(`update-record-${this.name}`).querySelector(`.modal-dialog *[name="${e[a].apiName}"]`),r=n.getAttribute("valore");if(n.getAttribute("fieldname")==this.paramObject.apiUrl.put.param&&(l.disabled=!0),"checkbox"==e[a].type)l.checked="S"==r;else if("decimalColor"==e[a].type){const e=this.getRGBFromNumber(r);l.style.backgroundColor=`rgb(${e.red},${e.green},${e.blue})`,l.addEventListener("change",(e=>{const t=this.getRGBFromNumber(e.target.value);e.target.style.backgroundColor=`rgb(${t.red},${t.green},${t.blue})`}))}else if("datenormal"==e[a].type){let e=r.split("/").reverse().join("-");l.valueAsDate=new Date(e)}else l.value="null"==r?"":r}})),n.appendChild(l);const r=document.createElement("td");t.appendChild(r);const o=document.createElement("button");o.id="deleteRecordBtn",o.className="btn-general-table",o.type="button",o.innerHTML='<svg height="16" width="14" viewBox="0 0 448 512"><path d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"/></svg>';const s={fields:{}};return o.addEventListener("click",(()=>{this.paramObject.apiUrl.delete.param.forEach((e=>{this.logger(o.parentElement);const t=o.parentElement.parentElement.querySelector(`td[fieldname="${e}"]`).getAttribute("valore");s.fields[e]=t})),this.openDeleteModal(s)})),r.appendChild(o),t};let n=this.getRGBFromNumber;for(let n=0;n<e.length;n++){let r=a(n);for(let t of this.paramObject.fields){let a=l(e[n],t);r.appendChild(a)}t.appendChild(r),t.scrollTop=0,document.getElementById("lateral-scroll").scrollLeft=0}function l(e,t){let a=document.createElement("td");switch(a.setAttribute("fieldName",t.apiName),a.setAttribute("valore",e[t.apiName]),t.type){case"checkbox":return function(e,n){let l=document.createElement("div");l.className="form-check",n&&(l.className+=` ${t.class}`),a.appendChild(l);let r=document.createElement("input");return r.type="checkbox",r.checked="S"==e,r.disabled=!0,r.className="form-check-input",l.appendChild(r),a}(e[t.apiName],t.class);case"dropdown":a.innerText=t.values["o"+e[t.apiName]]||"";break;case"decimalColor":let l=n(e[t.apiName]);a.style.backgroundColor=`rgb(${l.red},${l.green},${l.blue})`;break;case"datelong":a.innerText=function(e){const t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear()}\n${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`}(e[t.apiName]),a.setAttribute("valore",a.innerText);break;case"datenormal":a.innerText=function(e){const t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear()}`}(e[t.apiName]),a.setAttribute("valore",a.innerText);break;case"hidden":a.classList.add("d-none");break;case"button":let r=document.createElement("a");r.type="button",r.classList.add("btn","btn-secondary","opt-general-btn"),r.href=t.href.replace("{}",e[t.varValue]),r.innerHTML=t.svg,a.appendChild(r);break;default:a.innerText=e[t.apiName]}return t.class&&(a.className+=` ${t.class}`),a}}getRGBFromNumber(e){return{red:255&e,green:e>>8&255,blue:e>>16}}beginSearch(e){const t=e?e.target.value:document.getElementById("searchRecord").value;let a=document.querySelector('[aria-label="Research-Fields"]').value,n=Array.from(document.querySelectorAll(`#main-table-tbody td[fieldname="${a}"]`)).filter((e=>e.innerText.toLowerCase().includes(t.toLowerCase()))).map((e=>e.parentElement));document.querySelectorAll("#main-table-tbody tr").forEach((e=>{n.includes(e)?e.style.display="table-row":e.style.display="none"}))}changePage=async e=>{if(!this.isTableCreated)return;this.currentPage=e;let t=document.querySelector('.btn[selected="true"]');t&&t.removeAttribute("selected");let a,n=document.querySelector(`.btn[page="${e}"]`),l=document.querySelector("#selectEntries").value;if(n){this.logger("btn"),n.classList.contains("hide-element")&&(t.value>e?function(e,t){let a=Array.from(document.querySelectorAll(".page-button")),n=document.querySelector(`.btn[page="${t}"]`),l=a.indexOf(n);for(let t=l;t<=l+e&&a[t];t++)a[t].classList.add("hide-element"),a[t].parentElement.classList.add("hide-element");for(let t=l;t>=l-(e-1)&&a[t];t--)a[t].classList.remove("hide-element"),a[t].parentElement.classList.remove("hide-element");i(t)}(this.maxPageButtons,e):function(e,t){let a=Array.from(document.querySelectorAll(".page-button")),n=document.querySelector(`.btn[page="${t}"]`),l=a.indexOf(n);for(let t=l;t>=l-e&&a[t];t--)a[t].classList.add("hide-element"),a[t].parentElement.classList.add("hide-element");for(let t=l;t<=l+(e-1)&&a[t];t++)a[t].classList.remove("hide-element"),a[t].parentElement.classList.remove("hide-element");i(t)}(this.maxPageButtons,e));let r=document.querySelector("#previous-btn"),o=document.querySelector("#next-btn");n.value>1?r.removeAttribute("disabled"):r.setAttribute("disabled","true");let s=Array.from(document.querySelectorAll(".page-button"));n.value!=s[s.length-1].value?o.removeAttribute("disabled"):o.setAttribute("disabled","true"),n.setAttribute("selected","true"),a=await this.fetchGetApi(n.value,l),this.logger(a)}else a=await this.fetchGetApi(1,l),this.logger(a);let r=document.getElementById("main-table-tbody");this.logger(r.innerHTML),r.innerHTML="",this.logger(r.innerHTML),this.bodyGenerator(a.response,r);let o=1==e?1:l*(e-1)+1,s=l;return 1!=e&&(s=o+ +l>a.totalRecords?a.totalRecords:o+ +l-1),document.querySelector("#showNumber").innerText=`Showing ${o} to ${s} of the ${a.totalRecords} entries`,this.beginSearch(),a;function i(e){let t=Array.from(document.querySelectorAll(".page-button")),a=document.querySelector(`.btn[page="${e}"]`),n=(t.indexOf(a),document.querySelectorAll(".page-button:not(.hide-element)")),l=document.querySelector("#previous-more");n[0].value==t[0].value?(l.classList.add("hide-element"),l.parentElement.classList.add("hide-element")):(l.classList.remove("hide-element"),l.parentElement.classList.remove("hide-element"));let r=document.querySelector("#skip-more");n[n.length-1].value==t[t.length-1].value?(r.classList.add("hide-element"),r.parentElement.classList.add("hide-element")):(r.classList.remove("hide-element"),r.parentElement.classList.remove("hide-element"))}};async fetchApi(e,t,a){let n;a?.classList.remove("d-none");try{if(n=await fetch(e,t),!n.ok)return 401===n.status?{status:401,detail:"Non autorizzato"}:await n.json();const a=await n.json();return this.logger(a),a}catch(e){this.logger(e)}finally{a?.classList.add("d-none")}}async fetchGetApi(e,t){const a=this.paramObject.apiUrl.get.additionalParameters;let n="";if(a)for(let e of a)n+=`&Livello=${this.addParamObj[e]}`;let l={method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.paramObject.authToken,"Access-Control-Allow-Origin":"*"}},r=`${this.paramObject.apiUrl.get.url[0]+this.paramObject.apiUrl.get.url[1]}?Page=${e}&Limit=${t}${n}`;return this.logger("get url: "+r),await this.fetchApi(r,l)}async createTable(){let e=this.paramObject;this.isTableCreated=!0;const t=async()=>{if(this.paramObject.functions)for(const e of this.paramObject.functions)await e(this.addParamObj,this.changePage,r,this.currentPage)},a=e=>{let t=document.createElement("input");t.type="text",t.className="form-control",t.id="searchRecord",t.placeholder="Search...",e.appendChild(t),t.addEventListener("input",(e=>{this.beginSearch(e)}))},n=async(e,t,a)=>{let n=document.createElement("li");n.className="page-item border border-secondary border-opacity-25 rounded-0",t.appendChild(n);let l=document.createElement("button");l.type="button",l.className="btn btn-light rounded-0 page-button",l.setAttribute("page",e),l.innerText=e,l.value=e,e>this.maxPageButtons&&(l.classList.add("hide-element"),n.classList.add("hide-element")),1==e&&(l.setAttribute("selected","true"),a.setAttribute("disabled","true")),l.addEventListener("click",(async e=>{await this.changePage(e.target.value)})),n.appendChild(l)},l=async()=>{let t=document.querySelector("#selectEntries"),a=document.querySelector("#tLoader");t.addEventListener("change",(async()=>{a.classList.remove("d-none"),document.querySelector("#showNumber").innerText=`Showing 1 to ${t.value} of the ${o.totalRecords} entries`;let e=await this.changePage(1),n=document.querySelector('[aria-label="Page-navigation"]');n.innerHTML="",await r(e.totalPages,n),a.classList.add("d-none")})),e.paginationOptions.forEach((e=>{let a=document.createElement("option");a.value=e,a.innerText=e,t.appendChild(a)}))},r=async(e,t)=>{let a=document.createElement("ul");a.className="pagination m-3",t.appendChild(a);let l=document.createElement("li");l.className="page-item border border-secondary border-opacity-25 rounded-start",a.appendChild(l);let r=document.createElement("button");if(r.type="button",r.id="previous-btn",r.className="btn btn-light rounded-0 rounded-start",r.innerText="Previous",r.addEventListener("click",(async()=>{let e=document.querySelector('.btn[selected="true"]').value;await this.changePage(+e-1)})),l.appendChild(r),e>this.maxPageButtons){let e=document.createElement("li");e.className="page-item border border-secondary border-opacity-25 rounded-0 hide-element",a.appendChild(e);let t=document.createElement("button");t.type="button",t.className="btn btn-light rounded-0 hide-element",t.innerText="...",t.value="...",t.id="previous-more",t.addEventListener("click",(async()=>{let e=document.querySelectorAll(".page-button:not(.hide-element)")[0];await this.changePage(+e.value-1)})),e.appendChild(t)}for(let t=1;t<=e;t++)n(t,a,r);if(e>this.maxPageButtons){let e=document.createElement("li");e.className="page-item border border-secondary border-opacity-25 rounded-0",a.appendChild(e);let t=document.createElement("button");t.type="button",t.id="skip-more",t.className="btn btn-light rounded-0",t.innerText="...",t.value="...",t.addEventListener("click",(async()=>{let e=document.querySelectorAll(".page-button:not(.hide-element)"),t=e[e.length-1];await this.changePage(+t.value+1)})),e.appendChild(t)}let o=document.createElement("li");o.className="page-item border border-secondary border-opacity-25 rounded-end",a.appendChild(o);let s=document.createElement("button");s.type="button",s.id="next-btn",s.className="btn btn-light rounded-0 rounded-end",s.innerText="Next",s.disabled=e<2,s.addEventListener("click",(async()=>{let e=document.querySelector('.btn[selected="true"]').value;await this.changePage(+e+1)})),o.appendChild(s)};let o=await(async()=>{let n=document.querySelector("#tgen"),o=document.createElement("div");o.id="containerLayoutAziendale",o.className="container-fluid",n.appendChild(o);let s=document.createElement("div");s.className="row",o.appendChild(s);let i=document.createElement("div");i.className="col rounded-3 pt-3",i.id="table-background",s.appendChild(i);let d=document.createElement("div");d.className="row align-items-center mb-1",i.appendChild(d);const c=document.createElement("div");c.className="col-md-3 d-flex justify-content-start",c.id="container-options",d.appendChild(c);let m=document.createElement("span");m.id="tLoader",m.className="layout-loader",c.appendChild(m);let p=document.createElement("div");p.className="col-md-6 d-flex justify-content-center",d.appendChild(p),function(t){let a=document.createElement("select");a.className="form-select me-2",a.style.width="max-content",a.setAttribute("aria-label","Research-Fields"),t.appendChild(a),e.fields.filter((e=>"checkbox"!=e.type&&"decimalColor"!=e.type)).forEach((e=>{let t=document.createElement("option");t.value=e.apiName,t.innerText=e.displayedName,a.appendChild(t)}))}(p),a(p);let u=document.createElement("div");u.className="col-md-3 d-flex  justify-content-center",d.appendChild(u);let h=document.createElement("div");h.className="add-btn-wrapper pointer-pointer d-flex align-items-center border",h.setAttribute("data-bs-toggle","modal"),h.setAttribute("data-bs-target",`#create-record-${this.name}`),h.addEventListener("click",(()=>{let e=3;this.paramObject.apiUrl.post.param.forEach((t=>{const a=window.location.pathname.split("/")[e],n=document.querySelector(`#create-${this.name}-${t}-hidden`);n.value=a,n.type="hidden",e++}))})),u.appendChild(h);let b=document.createElement("div");b.className="me-1 add-record-button d-flex align-items-center justify-content-center",b.innerHTML='<svg viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM232 344V280H168c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H280v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"/></svg>',b.style.display="inline",h.appendChild(b);let g=document.createElement("p");g.innerText="Add new record",g.className="m-0",h.appendChild(g);let y=document.createElement("div");y.className="row h-58",y.id="lateral-scroll",i.appendChild(y);let f=document.createElement("div");f.className="col",y.appendChild(f);let E=document.createElement("table");E.className="table table-striped",f.appendChild(E);let v=document.createElement("thead");E.appendChild(v),(t=>{let a=e.fields,n=document.createElement("tr");t.appendChild(n);let l=document.createElement("th");l.scope="col",n.appendChild(l);let r=document.createElement("p");r.className="m-0",r.innerText="#",l.appendChild(r);const o=document.createElement("th");o.scope="col",n.appendChild(o);let s=document.createElement("p");s.className="m-0",s.innerText="Modifica",o.appendChild(s);const i=document.createElement("th");i.scope="col",n.appendChild(i);let d=document.createElement("p");d.className="m-0",d.innerText="Elimina",i.appendChild(d),a.forEach(((e,t)=>{let a=document.createElement("th");a.scope="col",n.appendChild(a);const l=document.createElement("div");let r=document.createElement("p");r.className="m-0",r.style.width="max-content",r.style.display="inline-block",r.innerText=e.displayedName,"hidden"==e.type&&a.classList.add("d-none"),l.appendChild(r),a.appendChild(l)}))})(v);let C=document.createElement("tbody");C.id="main-table-tbody",E.appendChild(C);let w=document.createElement("div");w.className="row align-items-center mt-3",i.appendChild(w);let N=document.createElement("div");N.id="entries-col",N.className="col-md-4 d-flex align-items-center",w.appendChild(N);let $=document.createElement("p");$.innerText="Show",$.className="m-0 show-entries-font",N.appendChild($);let L=document.createElement("select");L.id="selectEntries",L.className="form-select mx-1",L.setAttribute("aria-label","Number-of-Entries"),N.appendChild(L);let S=document.createElement("p");S.innerText="entries",S.className="m-0 show-entries-font",N.appendChild(S),l();let x=document.createElement("div");x.className="col-md-3 d-flex align-items-center justify-content-center show-entries-font",w.appendChild(x);let O=document.createElement("p");O.id="showNumber",O.className="m-0",x.appendChild(O);let A=document.createElement("div");A.className="col-md-5 d-flex justify-content-end",w.appendChild(A);let T=document.createElement("nav");if(T.setAttribute("aria-label","Page-navigation"),A.appendChild(T),await t(),!this.paramObject.authToken){const e=await this.logon();this.paramObject.authToken=e.access_token}let j=await this.fetchGetApi(1,e.paginationOptions[0]);return await r(j.totalPages,T),this.bodyGenerator(j.response,C),m.classList.add("d-none"),O.innerText=`Showing 1 to ${e.paginationOptions[0]} of the ${j.totalRecords} entries`,j})();this.apiResponse=o}logger(e){1==this.logs&&console.log(e)}}})(),TableGenerator=t.default})();